<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/perfilPaciente.css"> 
    <title>Paciente - Perfil | VidaPlus</title>
</head>
<body>
<header class="header">
    <div class="logo">VidaPlus</div>
    <nav class="nav-menu">
        <ul class="nav-links">
            <li><a href="/views/home.html">Home</a></li>
            <li><a href="#servicos">Servi√ßos</a></li>
        </ul>
        <div class="nav-buttons" id="navButtons"></div>
    </nav>
</header>

<main class="main-content">
    <div class="page-header">
        <h1 class="page-title">Perfil do Paciente</h1>
        <p class="page-subtitle">Detalhes do seu hist√≥rico m√©dico e tratamento</p>
    </div>

    <div class="patient-card">
        <div class="patient-info">
            <div class="patient-avatar">
                <div style="width:100%;height:100%;background:#ff9999;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem;font-weight:600">S</div>
            </div>
            <div class="patient-details">
                <h2>Sofia Almeida</h2>
                <div class="role">Paciente</div>
                <div class="id">ID do Paciente: 123456</div>
            </div>
        </div>

        <div class="tabs">
            <a href="#" class="tab active" data-tab="geral">Geral</a>
            <a href="#" class="tab" data-tab="exames">Exames</a>
            <a href="#" class="tab" data-tab="diagnosticos">Diagn√≥sticos</a>
        </div>

        <div class="tab-content active" id="geral">
            <div class="section">
                <h3 class="section-title">Informa√ß√µes Pessoais</h3>
                <div class="info-grid">
                    <div>
                        <div class="info-item">
                            <div class="info-label">Nome Completo</div>
                            <div class="info-value">Sofia Almeida</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Sexo</div>
                            <div class="info-value">Feminino</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Telefone</div>
                            <div class="info-value">+11 94545 5678</div>
                        </div>
                    </div>
                    <div>
                        <div class="info-item">
                            <div class="info-label">Data de Nascimento</div>
                            <div class="info-value">15 de Maio de 1994</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Endere√ßo</div>
                            <div class="info-value">Rua das Flores, 123, Lisboa</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Email</div>
                            <div class="info-value">sofia.almeida@email.com</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">Hist√≥rico de Consultas</h3>
                <div class="table-container">
                    <table>
                        <thead><tr><th>Data</th><th>M√©dico</th><th>Especialidade</th><th>Motivo</th></tr></thead>
                        <tbody>
                            <tr><td>10/01/2024</td><td>Dr. Carlos Pereira</td><td>Cardiologia</td><td>Check-up anual</td></tr>
                            <tr><td>15/04/2024</td><td>Dra. Ana Silva</td><td>Dermatologia</td><td>Consulta de rotina</td></tr>
                            <tr><td>20/06/2024</td><td>Dr. Jo√£o Santos</td><td>Ortopedia</td><td>Dor no joelho</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="tab-content" id="exames">
            <div class="section">
                <h3 class="section-title">Exames Realizados</h3>
                <div class="table-container">
                    <table>
                        <thead><tr><th>Data</th><th>Tipo de Exame</th><th>Resultado</th><th>Laudo</th><th>Imagens</th></tr></thead>
                        <tbody>
                            <tr><td>15/02/2024</td><td>Raio-X do T√≥rax</td><td>Normal</td><td><a href="#" class="btn-link">Visualizar</a></td><td><span class="exam-icon"></span></td></tr>
                            <tr><td>20/03/2024</td><td>Hemograma Completo</td><td>Dentro dos limites normais</td><td><a href="#" class="btn-link">Visualizar</a></td><td>-</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="tab-content" id="diagnosticos">
            <div class="section">
                <h3 class="section-title">Diagn√≥sticos</h3>
                <p style="color:#666;text-align:center;padding:2rem">Nenhum diagn√≥stico registrado.</p>
            </div>
        </div>
    </div>
</main>

<script>
// Fun√ß√µes de sess√£o
function saveAuth(data) {
    localStorage.setItem('authToken', data.token);
    localStorage.setItem('userName', data.user.nome);
}

function clearAuth() {
    localStorage.removeItem('authToken');
    localStorage.removeItem('userName');
}

function isLogged() {
    return !!localStorage.getItem('authToken');
}

function getUserName() {
    return localStorage.getItem('userName') || 'Usu√°rio';
}

// Fun√ß√£o para renderizar header
function renderHeader(navContainerId) {
    const nav = document.getElementById(navContainerId);
    if (!nav) {
        console.error('Elemento navButtons n√£o encontrado');
        return;
    }

    nav.innerHTML = '';

    // Bot√£o marcar consulta
    const marcar = document.createElement('a');
    marcar.href = '/views/marcarConsulta.html';
    marcar.className = 'btn-primary';
    marcar.textContent = 'Marcar Consulta';
    nav.appendChild(marcar);

    if (isLogged()) {
        const avatar = document.createElement('div');
        avatar.className = 'user-avatar';
        avatar.textContent = getUserName().trim().charAt(0).toUpperCase();
        avatar.title = 'Clique para sair';
        avatar.style.cursor = 'pointer';
        avatar.onclick = function() {
            if (confirm('Sair da conta?')) {
                clearAuth();
                renderHeader(navContainerId);
                window.location.href = '/views/home.html';
            }
        };
        nav.appendChild(avatar);
    } else {
        const login = document.createElement('a');
        login.href = '/views/login.html';
        login.className = 'btn-secondary';
        login.textContent = 'Cadastro/Login';
        nav.appendChild(login);
    }
}

function switchTabs(tabId) {
    console.log('üîÑ Trocando para aba:', tabId);

    const allTabs = document.querySelectorAll('.tab');
    allTabs.forEach(function(tab) {
        tab.classList.remove('active');
    });

    const allContents = document.querySelectorAll('.tab-content');
    allContents.forEach(function(content) {
        content.classList.remove('active');
    });

    const targetTab = document.querySelector('.tab[data-tab="' + tabId + '"]');
    if (targetTab) {
        targetTab.classList.add('active');
        console.log('‚úÖ Aba ativada:', tabId);
    } else {
        console.error('‚ùå Aba n√£o encontrada:', tabId);
    }

    const targetContent = document.getElementById(tabId);
    if (targetContent) {
        targetContent.classList.add('active');
        console.log('‚úÖ Conte√∫do ativado:', tabId);
    } else {
        console.error('‚ùå Conte√∫do n√£o encontrado:', tabId);
    }
}

document.addEventListener('DOMContentLoaded', function() {
    console.log('‚úÖ DOM carregado - Perfil Paciente');

    if (!isLogged()) {
        console.log('‚ö†Ô∏è Usu√°rio n√£o logado, criando sess√£o fake');
        saveAuth({ token: 'session', user: { nome: 'Sofia' } });
    }

    renderHeader('navButtons');

    const tabs = document.querySelectorAll('.tab');
    console.log('üìã Total de abas encontradas:', tabs.length);

    tabs.forEach(function(tab, index) {
        const tabId = tab.getAttribute('data-tab');
        console.log('üîó Configurando aba ' + (index + 1) + ':', tabId);

        tab.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('üñ±Ô∏è Clique na aba:', tabId);
            switchTabs(tabId);
        });
    });

    const tableRows = document.querySelectorAll('tbody tr');
    tableRows.forEach(function(row) {
        row.addEventListener('mouseenter', function() {
            this.style.background = '#f8f9fa';
        });

        row.addEventListener('mouseleave', function() {
            this.style.background = '';
        });
    });

    console.log('‚úÖ Perfil Paciente inicializado com sucesso');
});
</script>
</body>
</html>
